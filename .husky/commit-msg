#!/bin/sh

echo "üîç Checking commit message for sign-off..."

# The commit message file is passed as the first argument
commit_msg_file="$1"

# Validate that the commit message file argument is provided
if [ -z "$commit_msg_file" ]; then
    echo "‚ùå Error: No commit message file provided"
    exit 1
fi

# Validate that the commit message file exists
if [ ! -f "$commit_msg_file" ]; then
    echo "‚ùå Error: Commit message file not found: $commit_msg_file"
    exit 1
fi

# Check if the commit message contains "Signed-off-by:"
if ! grep -q "^Signed-off-by: " "$commit_msg_file"; then
    echo "‚ùå Commit is not signed off!"
    echo ""
    echo "Your commit message must include a 'Signed-off-by' line."
    echo "Please use 'git commit -s' to sign off your commit."
    echo ""
    echo "Example: git commit -s -m 'your commit message'"
    echo ""
    echo "This adds a 'Signed-off-by' line to indicate you have read and"
    echo "agreed to the project's contribution guidelines."
    exit 1
fi

echo "‚úÖ Commit is properly signed off!"
